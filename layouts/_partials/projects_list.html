{{/* Main projects list page */}}
{{ $projectSections := where .Pages "Kind" "section" }}
{{ $sortedProjects := slice }}
{{ range $projectSections }}
  {{ $latestDate := .Date }}
  {{ if .RegularPages }}
    {{ $latestPost := index (.RegularPages.ByDate.Reverse) 0 }}
    {{ $latestDate = $latestPost.Date }}
  {{ end }}
  {{ $sortedProjects = $sortedProjects | append (dict "section" . "latestDate" $latestDate) }}
{{ end }}
{{ $sortedProjects = sort $sortedProjects "latestDate" "desc" }}

{{ range $sortedProjects }}
{{ $section := .section }}
<div class="my-4">
  <article>
    <div class="flex flex-col md:flex-row gap-4">
      {{ with $section.Params.image }}
      <div class="flex-shrink-0">
        <a href="{{ $section.Permalink }}">
          <img src="/images/{{ . }}" alt="{{ $section.Title }}" class="w-full md:w-48 h-auto rounded-lg">
        </a>
      </div>
      {{ end }}
      <div class="flex-grow">
        <div class="flex flex-col md:flex-row gap-2 md:gap-4">
          <h2><a href="{{ $section.Permalink }}">{{ $section.Title }}</a></h2>
          <time class="text-sm md:text-base">{{ .latestDate.Format "January 2, 2006" }}</time>
        </div>
        <p>{{ $section.Summary }}</p>
      </div>
    </div>
  </article>
</div>
<div class="divider"></div>
{{ end }}
